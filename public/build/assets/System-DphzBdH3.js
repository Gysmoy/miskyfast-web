import{j as e}from"./highlightText-Cf8x2fCZ.js";import{r as i}from"./index-BH53Isel.js";import{c as Ce}from"./ReactAppend-QR5TrZfj.js";import{G as je,C as ke}from"./CreateReactScript-BkuQg66_.js";import{i as I,a as ye,M as me}from"./MenuItemContainer-D-Aykn96.js";import{S as q}from"./SystemRest-Dnzj8Fo-.js";import{S as fe}from"./SwitchFormGroup-DcdO04QX.js";import{I as ve}from"./InputFormGroup-DrEiC8gn.js";import{T as Ne}from"./TextareaFormGroup-qAJYvfmt.js";import{M as ue}from"./Modal-CjnGE3_J.js";import{S as Q}from"./SelectFormGroup-CVmlaBEm.js";import{S as Re}from"./SetSelectValue-UxyCmHse.js";import{C as Se,S as $e}from"./SettingsRest-BjoxMfFp.js";import{G as Ee}from"./GalleryRest-BISAIV_6.js";import"./index-yBjzXJbu.js";import"./index-B6ujFmsw.js";import"./index.esm-QEAFbt3Y.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./main-CZ_LA3zH.js";/* empty css               *//* empty css              */import"./index-fRpqIG3j.js";import"./BasicRest-BSN0iM7g.js";const re=(s="")=>{s=s.replace(/[^a-zA-Z0-9_{}]/g,"");const n=/{([^}]+)}/g,l=[];let u;for(;(u=n.exec(s))!==null;)l.push(u[1]);return l},Pe=(s,n)=>{const l=new RegExp(`[${n}]+$`,"g");return s.replace(l,"")},ne=new q,Fe=s=>{const{id:n,name:l,path:u,extends_base:m=!1,menuable:p=!1,setPages:h,onSEOClicked:a,onParamsClicked:c}=s,[o,r]=i.useState(!1),[d,b]=i.useState(!1),[j,R]=i.useState(!1),[k,x]=i.useState(!1),g=async N=>{if(l===N.target.value)return r(!1);ne.savePage({id:n,name:N.target.value})&&(r(!1),h(P=>P.map(w=>w.id===n?{...w,name:N.target.value}:w)))},y=async N=>{if(u===N.target.value)return b(!1);const S=N.target.value;let P=structuredClone(S);const w=s.using??{};for(const B of re(S))P=P.replace(`{${B}}`,"").replace(`{${B}?}`,""),w[B]=w[B]??{model:null};const F=Pe(P,"/");ne.savePage({id:n,path:S,pseudo_path:F,using:Object.keys(w).length>0?w:void 0})&&(b(!1),h(B=>B.map(_=>_.id===n?{..._,path:N.target.value}:_)))},A=async N=>{R(!0);const S=N.target.checked,P=ne.savePage({id:n,extends_base:S});R(!1),P&&h(w=>w.map(F=>F.id===n?{...F,extends_base:S}:F))},U=async N=>{x(!0);const S=N.target.checked,P=ne.savePage({id:n,menuable:S});x(!1),P&&h(w=>w.map(F=>F.id===n?{...F,menuable:S}:F))},V=async N=>{await ne.deletePage(N.id)&&(h(P=>P.filter(w=>w.id!=N.id)),$('[data-bs-toggle="tab"]').removeClass("active"),$(".tab-pane").removeClass("active"),$("#base-template-link").addClass("active"),$("#base-template").addClass("active"))},Y=re(u);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dropdown float-end",children:[e.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"mdi mdi-dots-vertical"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-end",children:[e.jsxs("button",{className:"dropdown-item",onClick:()=>a(s),children:[e.jsx("i",{className:"mdi mdi-cloud-search-outline me-1"}),"Editar SEO"]}),Y.length>0&&e.jsxs("button",{className:"dropdown-item",onClick:()=>c(s),children:[e.jsx("i",{className:"mdi mdi-code-braces me-1"}),"Parámetros"]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item",onClick:()=>V(s),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar página"]})]})]}),e.jsxs("div",{children:[o?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:l,onBlur:g,autoFocus:!0}):e.jsx(I,{content:"Editar nombre",placement:"left",children:e.jsx("h4",{className:"header-title mb-1 d-block",onClick:()=>r(!0),style:{minWidth:"200px",cursor:"pointer"},children:l||"Sin nombre"})}),d?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:u,style:{minHeight:27,fieldSizing:"content"},onBlur:y,autoFocus:!0}):e.jsx(I,{content:"Editar ruta",placement:"left",children:e.jsx("small",{className:"text-muted d-block mb-1",onClick:()=>b(!0),style:{minWidth:"200px",cursor:"pointer"},children:u||"Sin ruta"})})]}),e.jsxs("div",{className:"row",children:[e.jsx(fe,{label:"Extiende de base",col:"col-lg-6 col-md-12 col-sm-6",checked:m,onChange:A,disabled:j}),e.jsx(fe,{label:"Mostrar en menu",col:"col-lg-6 col-md-12 col-sm-6",checked:p,onChange:U,disabled:k})]})]})},pe=s=>{const n=Object.fromEntries(s.map(a=>[a.id,a])),l=new Set,u=[],m=new Set;function p(a){if(!l.has(a.id)){if(a.after_component){const c=n[a.after_component];if(c)p(c);else{m.add(a);return}}u.push(a),l.add(a.id)}}s.forEach(a=>{p(a)});const h=Array.from(m).sort((a,c)=>new Date(a.created_at)-new Date(c.created_at)).filter(a=>!l.has(a.id));return[...u,...h]},Me=new q,Be=({dataLoaded:s,setDataLoaded:n,modalRef:l})=>{const u=i.useRef(null),m=i.useRef(null),p=i.useRef(null),h=async a=>{a.preventDefault(),await Me.savePage({id:s.id,description:m.current.value,keywords:$(p.current).val()})&&(n(null),$(l.current).modal("hide"))};return i.useEffect(()=>{u.current.value=`${s==null?void 0:s.name} | ${je.APP_NAME}`,m.current.value=(s==null?void 0:s.description)??"",Re(p.current,(s==null?void 0:s.keywords)??[])},[s]),e.jsx(ue,{modalRef:l,title:`Editar SEO - ${s==null?void 0:s.name}`,size:"sm",onSubmit:h,children:e.jsxs("div",{id:"seo-container",children:[e.jsx(ve,{eRef:u,label:"Título",disabled:!0}),e.jsx(Ne,{eRef:m,label:"Descripción",rows:2}),e.jsx(Q,{eRef:p,label:"Palabras clave",tags:!0,multiple:!0,dropdownParent:"#seo-container"})]})})},xe=({className:s,system:n,component:l,onComponentClicked:u,onDeleteClicked:m,onEditDataClicked:p})=>{var c;const h=(l==null?void 0:l.options)??[],a=h.find(o=>o.id==n.value);return e.jsxs("div",{className:`dropdown ${s}`,"data-id":n.id,children:[e.jsxs("div",{className:"btn btn-light dropdown-toggle text-truncate w-100 text-start",type:"button",id:`dd-${n.id}`,"data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true",children:[e.jsx("i",{className:"mdi mdi-chevron-down ms-1 float-end"}),e.jsxs("span",{className:"handle-sortable",style:{cursor:"move"},children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"})]}),e.jsx("span",{className:"ms-1",children:n.name})]}),e.jsxs("div",{className:"dropdown-menu","aria-labelledby":`dd-${n.id}`,"data-popper-placement":"bottom-start",children:[h.length>1&&e.jsxs(e.Fragment,{children:[h.filter(o=>o.id!=n.value).map(o=>e.jsxs("button",{className:"dropdown-item",onClick:()=>u({...n,name:`${l.name} - ${o.name}`,value:o.id}),children:[l.name," - ",o.name]})),e.jsx("div",{className:"dropdown-divider"})]}),(((c=a==null?void 0:a.using)==null?void 0:c.filters)||(a==null?void 0:a.data))&&e.jsxs("button",{className:"dropdown-item",onClick:()=>p(n,a),children:[e.jsx("i",{className:"mdi mdi-pencil me-1"}),"Configurar datos"]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>m(n),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar"]})]})]})},_e=({col:s,label:n,eRef:l,placeholder:u,required:m=!1,rows:p=3,value:h,onChange:a=()=>{}})=>{const[c,o]=i.useState(h),r=i.useRef(),d=i.useRef(null),b=l||r;return i.useEffect(()=>(d.current&&(d.current.toTextArea(),d.current=null),d.current=CodeMirror.fromTextArea(b.current,{mode:"htmlmixed",theme:"sode",indentUnit:2,tabSize:2}),d.current.setValue(h),setTimeout(()=>{d.current.refresh()},125),d.current.on("change",j=>{const R=j.getValue();o(R),a({target:{value:R}})}),()=>{d.current&&(d.current.toTextArea(),d.current=null)}),[b]),i.useEffect(()=>{c!==h&&(o(h),d.current&&(d.current.setValue(h),setTimeout(()=>{d.current.refresh()},125)))},[h]),e.jsxs("div",{className:`form-group ${s} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[n," ",m&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("textarea",{ref:b,className:"form-control",placeholder:u,required:m,rows:p,defaultValue:h,onChange:j=>o(j.target.value)})]})},be=new q,De=({dataLoaded:s,setDataLoaded:n,setSystems:l,modalRef:u})=>{var d,b,j,R,k,x,g,y,A,U,V,Y,N,S,P,w,F,H,B,_,L,ee;const[m,p]=i.useState((s==null?void 0:s.data)||{}),[h,a]=i.useState([]),c={};c.model=i.useRef(null),c.filters=i.useRef(null),c.filtersMethod=i.useRef(null);const o=async f=>{var E,z;f.preventDefault();const M=await be.save({id:s.id,data:m,filters:$(c.filters.current).val(),filters_method:(z=(E=s==null?void 0:s.component)==null?void 0:E.using)==null?void 0:z["filters:method"],filters_method_values:$(c.filtersMethod.current).val()});M&&(n(null),$(u.current).modal("hide"),l(J=>J.map(W=>W.id==s.id?M:W)))};i.useEffect(()=>{var z,J,W,le,ie,se,ce;const f={};(z=s==null?void 0:s.component)==null||z.data.forEach(X=>{var ae;f[X]=((ae=s==null?void 0:s.data)==null?void 0:ae[X])??""}),p(f),c.model.current.value=((W=(J=s==null?void 0:s.component)==null?void 0:J.using)==null?void 0:W.model)??"",$(c.filters.current).val((s==null?void 0:s.filters)??[]).trigger("change"),$(c.filtersMethod.current).val((s==null?void 0:s.filtersMethod)??[]).trigger("change");const M=(ie=(le=s==null?void 0:s.component)==null?void 0:le.using)==null?void 0:ie.model,E=(ce=(se=s==null?void 0:s.component)==null?void 0:se.using)==null?void 0:ce["filters:method"];!M||!E||be.simpleGet(`/api/admin/system/related/${M}/${E}`).then(X=>{a(X)})},[s]);const r=(f,M)=>{p({...m,[f]:M})};return e.jsxs(ue,{modalRef:u,title:s==null?void 0:s.name,onSubmit:o,size:(b=(d=s==null?void 0:s.component)==null?void 0:d.data)!=null&&b.some(f=>f.startsWith("code:"))?"lg":"md",children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered",children:[e.jsx("li",{className:"nav-item",hidden:!((R=(j=s==null?void 0:s.component)==null?void 0:j.data)!=null&&R.length),children:e.jsx("a",{href:"#tab-info","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link active",children:"Información"})}),e.jsx("li",{className:"nav-item",hidden:!((x=(k=s==null?void 0:s.component)==null?void 0:k.using)!=null&&x.filters)&&!((y=(g=s==null?void 0:s.component)==null?void 0:g.using)!=null&&y["filters:method"]),children:e.jsx("a",{href:"#tab-db","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link",children:"Base de datos"})})]}),e.jsxs("div",{className:"tab-content",id:"data-modal-container",children:[e.jsx("div",{className:"tab-pane active",id:"tab-info",hidden:!((U=(A=s==null?void 0:s.component)==null?void 0:A.data)!=null&&U.length),children:(Y=(V=s==null?void 0:s.component)==null?void 0:V.data)==null?void 0:Y.map((f,M)=>f.startsWith("code:")?e.jsx(_e,{label:f.replace("code:",""),value:m[f]??"",rows:1,onChange:E=>p({...m,[f]:E.target.value})},M):e.jsx(e.Fragment,{children:f.startsWith("bool:")?e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:f.replace("bool:","")}),e.jsxs("div",{children:[e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${f}-true`,name:f,value:"true",checked:m[f]===!0,onChange:E=>r(f,E.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${f}-true`,children:"Sí"})]}),e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${f}-false`,name:f,value:"false",checked:m[f]===!1,onChange:E=>r(f,E.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${f}-false`,children:"No"})]})]})]}):e.jsx(Ne,{label:f,value:m[f]??"",rows:1,onChange:E=>p({...m,[f]:E.target.value})},M)}))}),e.jsxs("div",{className:"tab-pane show",id:"tab-db",children:[e.jsx(ve,{eRef:c.model,label:"Modelo",disabled:!0}),e.jsx(Q,{eRef:c.filters,label:"Filtros",multiple:!0,dropdownParent:"#tab-db",hidden:!((S=(N=s==null?void 0:s.component)==null?void 0:N.using)!=null&&S.filters),children:(F=(w=(P=s==null?void 0:s.component)==null?void 0:P.using)==null?void 0:w.filters)==null?void 0:F.map((f,M)=>e.jsx("option",{value:f,children:f},M))}),e.jsx("div",{hidden:!((B=(H=s==null?void 0:s.component)==null?void 0:H.using)!=null&&B["filters:method"]),children:e.jsx(Q,{eRef:c.filtersMethod,label:(ee=(L=(_=s==null?void 0:s.component)==null?void 0:_.using)==null?void 0:L["filters:method"])==null?void 0:ee.toTitleCase(),multiple:!0,dropdownParent:"#tab-db",changeWith:[h],children:h==null?void 0:h.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))})})]})]})]})},ge=new q,Ie=({components:s,onClick:n})=>e.jsx("div",{className:"left-side-menu top-0 pt-2",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsx("div",{id:"sidebar-menu",className:"show",children:e.jsxs("ul",{id:"side-menu",children:[e.jsx("li",{className:"menu-title",children:"Lista de componentes"}),s.filter(l=>l.options.length>0).map((l,u)=>e.jsx(ye,{title:l.name,icon:l.icon,children:l.options.map((m,p)=>e.jsx(me,{name:m.name,icon:m.icon,onClick:()=>{const h=$(".tab-pane:visible .components-container > div").last().data("id");n({name:`${l.name} - ${m.name}`,component:l.id,value:m.id,after_component:h})},children:m.name},p))},u)),e.jsx("li",{className:"menu-title",children:"Sistema de respaldo"}),e.jsx(me,{icon:"mdi mdi-cogs",rightBarToggle:!0,children:"Configuraciones"}),e.jsx(me,{icon:"mdi mdi-cloud-download",onClick:async()=>{const l=await ge.exportBK(),u=new Blob([JSON.stringify(l)],{type:"application/json"}),m=URL.createObjectURL(u),p=document.createElement("a");p.href=m,p.download="backup.json",document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(m)},children:"Exportar Backup"}),e.jsx("input",{type:"file",id:"file-input",accept:"application/json",style:{display:"none"},onChange:async l=>{const u=l.target.files[0];if(l.target.value=null,u){const m=new FormData;if(m.append("backup",u),!await ge.importBK(m))return;location.reload()}}}),e.jsx(me,{icon:"mdi mdi-backup-restore",onClick:()=>{document.getElementById("file-input").click()},children:"Importar Backup"})]})}),e.jsx("div",{className:"clearfix"})]})}),Ae=({page:s,param:n,models:l,setUsing:u,setPages:m})=>{var j,R,k;const p=i.useRef(),h=i.useRef(),a=i.useRef(),c=s==null?void 0:s.using,[o,r]=i.useState(null),d=x=>{const g=p.current.value,y=l.find(A=>A.name==g)??null;r(y)};i.useEffect(()=>{var x;$(p.current).val((x=c==null?void 0:c[n])==null?void 0:x.model).trigger("change")},[n]),i.useEffect(()=>{var x,g;u(y=>({...y,[n]:{...y[n],model:(o==null?void 0:o.name)??null}})),$(h.current).val(((x=c==null?void 0:c[n])==null?void 0:x.field)??null).trigger("change"),$(a.current).val(((g=c==null?void 0:c[n])==null?void 0:g.relations)??[]).trigger("change")},[o]);const b=`${n}-container`;return e.jsxs("div",{id:b,className:"row",children:[e.jsxs("label",{className:"form-label",children:["Parámetro ",e.jsx("code",{children:n})]}),e.jsx(Q,{eRef:p,label:"Modelo",col:"col-md-6",dropdownParent:`#${b}`,onChange:d,children:l.map((x,g)=>e.jsx("option",{value:x.name,children:x.name},g))}),e.jsx(Q,{eRef:h,label:"Campo",col:"col-md-6",dropdownParent:`#${b}`,onChange:x=>{u(g=>({...g,[n]:{...g[n],field:x.target.value}}))},children:(j=o==null?void 0:o.fields)==null?void 0:j.map((x,g)=>e.jsx("option",{children:x},g))}),e.jsx("div",{hidden:(((R=o==null?void 0:o.relations)==null?void 0:R.length)??0)==0,children:e.jsx(Q,{eRef:a,label:"Relaciones",multiple:!0,dropdownParent:`#${b}`,onChange:x=>{const g=$(x.target).val();u(y=>({...y,[n]:{...y[n],relations:g}}))},children:(k=o==null?void 0:o.relations)==null?void 0:k.map((x,g)=>e.jsx("option",{children:x},g))})})]})},Ve=new q,Oe=({dataLoaded:s,setDataLoaded:n,setPages:l,modalRef:u,models:m})=>{const p=re((s==null?void 0:s.path)??""),[h,a]=i.useState({}),c=async o=>{o.preventDefault();const r=await Ve.savePage({id:s.id,using:h});r&&(n(null),l(r),$(u.current).modal("hide"))};return i.useEffect(()=>{a((s==null?void 0:s.using)??{})},[s]),e.jsx(ue,{modalRef:u,title:`Editar parámetros de URL - ${s==null?void 0:s.name}`,onSubmit:c,onClose:()=>n(null),children:p.map((o,r)=>e.jsx(Ae,{page:s,param:o,models:m,using:h,setUsing:a,setPages:l},r))})},ze=new Ee,Te=new Se,Ge=new $e,Ue=({colors:s,setColors:n,settings:l,setSettings:u})=>{const[m,p]=i.useState([{uuid:crypto.randomUUID(),col:"col-3",name:"Icon (1:1)",src:"icon.png",width:"100%",aspectRatio:1},{uuid:crypto.randomUUID(),col:"col-5",name:"Logo (13:4)",src:"logo.png",width:"100%",aspectRatio:3.25},{uuid:crypto.randomUUID(),col:"col-4",name:"Logo footer (1:1)",src:"logo-footer.png",width:"100%",aspectRatio:1}]),h=async r=>{var k;const d=((k=r.target.files)==null?void 0:k[0])??null;if(!d)return;r.target.value=null;const b=r.target.name,j=new FormData;j.append("image",d),j.append("name",b),await ze.save(j)&&p(x=>x.map(g=>(g.src==b&&(g.uuid=crypto.randomUUID()),g)))},a=async r=>{const d=r.target.getAttribute("data-color-id"),b=r.target.name,j=r.target.value;if(s.find(x=>x.id==d)[b]===j)return;const k=await Te.save({id:d,[b]:j});k&&n(x=>x.map(g=>g.id==d?k.data:g))},c=async r=>{var x;const d=r.target.getAttribute("data-id"),b=r.target.name;let j=r.target.value;if(r.target.type=="checkbox"&&(j=r.target.checked?"true":"false"),(((x=l.find(g=>g.name==b))==null?void 0:x.description)??"")===j)return;const k=await Ge.save({name:b,value:j});k&&u(g=>g.map(y=>y.id==d?k.data:y))},o=r=>{const d=l.find(b=>b.name==r);return d?d.value:""};return e.jsx("div",{className:"right-bar",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsxs("div",{className:"rightbar-title",children:[e.jsx("a",{href:"#",className:"right-bar-toggle float-end",children:e.jsx("i",{className:"mdi mdi-close"})}),e.jsx("h4",{className:"font-16 m-0 text-white",children:"Configuraciones"})]}),e.jsxs("div",{className:"p-2",children:[e.jsx("h5",{children:"Imágenes principales"}),e.jsx("div",{className:"row",children:m.map((r,d)=>{const b="file-"+r.uuid;return e.jsxs("div",{className:r.col,children:[e.jsx("input",{id:b,name:r.src,type:"file",accept:"image/png",hidden:!0,onChange:h}),e.jsx("label",{htmlFor:b,className:"form-label d-block mb-1",style:{cursor:"pointer"},children:r.name}),e.jsx("label",{htmlFor:b,style:{cursor:"pointer"},className:"w-100",children:e.jsx("img",{className:"border",src:`/assets/resources/${r.src}?v=${r.uuid}`,alt:"",style:{height:r.height,width:r.width,objectFit:"contain",objectPosition:"center",backgroundColor:"#f5f5f5",borderRadius:"4px",aspectRatio:r.aspectRatio}})})]},d)})}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Fuentes del sistema"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Titulos"}),e.jsx(I,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"title-font-name",defaultValue:o("title-font-name"),onBlur:c})}),e.jsx(I,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"title-font-url",defaultValue:o("title-font-url"),onBlur:c,style:{minHeight:27,fieldSizing:"content"}})}),e.jsx(I,{content:"Marcar si el archivo es un archivo de fuente (otf, woff, woff2, etc)",children:e.jsxs("div",{className:"form-check mt-1",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",name:"title-font-source",id:"title-font-source",defaultChecked:o("title-font-source")=="true",onBlur:c}),e.jsx("label",{className:"form-check-label",htmlFor:"title-font-source",children:"¿Es este un archivo de fuente?"})]})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Parrafos"}),e.jsx(I,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"paragraph-font-name",defaultValue:o("paragraph-font-name"),onBlur:c})}),e.jsx(I,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"paragraph-font-url",defaultValue:o("paragraph-font-url"),onBlur:c,style:{minHeight:27,fieldSizing:"content"}})}),e.jsx(I,{content:"Marcar si el archivo es un archivo de fuente (otf, woff, woff2, etc)",children:e.jsxs("div",{className:"form-check mt-1",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",name:"paragraph-font-source",id:"paragraph-font-source",defaultChecked:o("paragraph-font-source")=="true",onBlur:c}),e.jsx("label",{className:"form-check-label",htmlFor:"paragraph-font-source",children:"¿Es este un archivo de fuente?"})]})})]}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Colores del sistema"}),e.jsx("div",{className:"d-flex flex-column gap-1",children:s.map((r,d)=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text px-1",children:e.jsx("input",{type:"color",name:"description","data-color-id":r.id,className:"p-0",style:{width:"20px",height:"20px",border:"1px solid #ced4da",borderRadius:"4px",cursor:"pointer"},defaultValue:r.description,onBlur:a})}),e.jsx("input",{type:"text",name:"name","data-color-id":r.id,className:"form-control form-control-sm",placeholder:"Color",defaultValue:r.name,onBlur:a,disabled:r.name=="primary",style:{cursor:r.name=="primary"?"not-allowed":"text"}})]},d))})]})]})})},Z=new q,He=({systems:s=[],pages:n=[],colors:l=[],components:u,models:m,settings:p=[]})=>{const h=i.useRef(null),a=i.useRef(null),c=i.useRef(null),o=i.useRef(null),[r,d]=i.useState(s),[b,j]=i.useState(n),[R,k]=i.useState(l),[x,g]=i.useState(p),[y,A]=i.useState(!1),[U,V]=i.useState(null),[Y,N]=i.useState(null),[S,P]=i.useState(!1),[w,F]=i.useState(!1),[H,B]=i.useState(null),[_,L]=i.useState(!1),[ee,f]=i.useState(0),M=async()=>{A(!0);const t=await Z.savePage();t&&(A(!1),j(t))},E=async t=>{const v=$(".tab-pane:visible").data("id")??null;t.page_id=v;const D=await Z.save(t);if(!D)return;const T=D;d(G=>G.some(O=>O.id===T.id)?G.map(O=>O.id===T.id?T:O):[...G,T])},z=async t=>{await Z.delete(t.id)&&d(v=>v.filter(D=>D.id!=t.id))},J=async()=>{L(!0);const t=await Z.fetchRemoteChanges();L(!1),t&&location.reload()},W=t=>{const C=$(t.target).data("page-id"),v=$(t.target).data("page-path"),D=$(t.target).val();$(`#iframe-${C}`).removeAttr("src"),$(`#iframe-${C}`).attr("src",`${v}/${D}`)},le=async t=>{V(t),$(h.current).modal("show")},ie=async t=>{V(t),$(a.current).modal("show")},se=async(t,C)=>{N({...t,component:C}),$(o.current).modal("show")};i.useEffect(()=>{let t=null;const C=async()=>{if(_)return;if(S){clearInterval(t);return}const v=await Z.hasRemoteChanges();if(!v){P(!0);return}F(v.has_changes),B(v.last_commit),f(v.commits)};return t=setInterval(async()=>{await C()},1e4),()=>clearInterval(t)},[S,_]),i.useEffect(()=>{const t=$("iframe:visible");t&&($(t).removeAttr("src"),$(t).attr("src",t.data("path")))},[r,R,x]),i.useEffect(()=>{[...$(".components-container")].forEach(C=>{$(C).sortable({connectWith:".components-container",handle:".handle-sortable",forcePlaceholderSize:!0,update:async function(v,D){const T=[...$(C).children()],G={};if(T.forEach(oe=>{const O=$(oe).data("id"),K=$(oe).prev().data("id")??null,te=r.find(de=>de.id==O);(te==null?void 0:te.after_component)!==K&&(G[O]=K)}),Object.keys(G).length>0){if(!await Z.updateOrder(G))return;d(O=>{const K=[...O];return Object.entries(G).forEach(([te,de])=>{const he=K.findIndex(we=>we.id==te);he!==-1&&(K[he]={...K[he],after_component:de})}),K})}}}).disableSelection()})},[b,r]),i.useEffect(()=>{document.title=`Sistema | ${je.APP_NAME}`},[null]);const[ce,X,ae]=(H==null?void 0:H.split(`
`))??[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"wrapper position-relative",children:[e.jsx(Ie,{components:u,onClick:E}),e.jsx("div",{className:"content-page mt-2 pb-3",style:{height:"max-content"},children:e.jsx("div",{className:"content mt-2",children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("button",{className:"button-menu-mobile d-lg-none d-md-block position-absolute ",style:{zIndex:1,border:"none",borderRadius:"0 50% 50% 0",backgroundColor:"#fff",color:"#343a40",top:"50%",left:"0",transform:"translateY(-50%)",padding:"24px 0px 20px 6px ",fontWeight:"bold"},children:"〉"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card mb-0",children:e.jsxs("div",{className:"card-body",style:{height:"calc(100vh - 48px)"},children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered flex-nowrap",style:{overflowX:"auto",overflowY:"hidden"},children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{id:"base-template-link",href:"#base-template","data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link active h-100",children:"Base"})}),b.map((t,C)=>e.jsx("li",{className:"nav-item",children:e.jsxs("a",{href:`#page-${t.id}`,"data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link h-100",style:{whiteSpace:"nowrap"},children:[t.name,e.jsx("small",{className:"d-block text-muted",style:{fontWeight:"normal"},children:t.path})]})},C)),e.jsx("li",{className:"nav-item d-flex justify-content-center align-items-center px-2",children:e.jsx(I,{content:"Agregar página",children:e.jsx("button",{className:"nav-link btn btn-xs btn-white rounded-pill",onClick:M,disabled:y,children:y?e.jsx("i",{className:"mdi mdi-loading mdi-spin"}):e.jsx("i",{className:"mdi mdi-plus"})})})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane active",id:"base-template",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":null,children:pe(r).filter(t=>t.page_id==null).map(t=>{const C=u.find(v=>v.id==t.component);if(C==null||C.options,t.component=="content")return e.jsxs("button",{"data-id":t.id,className:"btn btn-light text-truncate w-100 text-start",type:"button",children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("span",{className:"ms-1",children:t.name})]},t.id);{const v=u.find(D=>D.id==t.component);return e.jsx(xe,{className:"",system:t,component:v,onComponentClicked:E,onDeleteClicked:z,onEditDataClicked:se},t.id)}})})}),e.jsx("div",{className:"col-md-8",children:e.jsx("iframe",{src:"/base-template","data-path":"/base-template",className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 200px)",borderRadius:"4px"}})})]})}),b.map((t,C)=>e.jsx("div",{className:"tab-pane",id:`page-${t.id}`,"data-id":t.id,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx(Fe,{...t,models:m,setPages:j,onSEOClicked:le,onParamsClicked:ie}),e.jsx("hr",{className:"my-2"}),e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":t.id,children:pe(r).filter(v=>v.page_id==t.id).map(v=>{const D=u.find(T=>T.id==v.component);return e.jsx(xe,{className:"",system:v,component:D,onComponentClicked:E,onDeleteClicked:z,onEditDataClicked:se},v.id)})})]}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"input-group mb-2",children:[e.jsxs("span",{className:"input-group-text",children:[(t==null?void 0:t.pseudo_path)||t.path,re(t==null?void 0:t.path).length>0&&"/"]}),re(t==null?void 0:t.path).length>0&&e.jsx("input",{type:"text",className:"form-control",placeholder:"Parametros","data-page-path":t.pseudo_path,"data-page-id":t.id,onChange:W})]}),e.jsx("iframe",{id:`iframe-${t.id}`,src:(t==null?void 0:t.pseudo_path)||t.path,"data-path":(t==null?void 0:t.pseudo_path)||t.path,className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 302px)",borderRadius:"4px"}})]})]})},C))]})]})})})})]})})}),w&&e.jsx(I,{content:`Tienes ${ee} cambios sin sincronizar`,children:e.jsxs("button",{className:"btn btn-dark p-0 position-absolute rounded-pill",style:{right:"20px",bottom:"20px",height:"40px",width:"40px"},onClick:()=>$(c.current).modal("show"),children:[e.jsx("small",{className:"position-absolute",style:{backgroundColor:"#ff5b5b",borderRadius:"50%",width:"18px",height:"18px",top:"-5px",left:"-5px"},children:ee}),e.jsx("i",{className:"mdi mdi-github mdi-24px"})]})})]}),e.jsx(ue,{modalRef:c,title:"Cambios de Github",size:"sm",hideFooter:!0,children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"mdi mdi-github mdi-48px"}),e.jsx("h5",{className:"mt-2",children:"Tienes cambios sin sincronizar"}),e.jsxs("div",{className:"mb-2 py-2",children:[e.jsx("b",{className:"d-block",children:ce}),e.jsx("small",{className:"d-block text-muted",children:moment(X).fromNow()}),e.jsxs("span",{className:"d-block",children:["Commit: ",ae]})]}),e.jsx("button",{className:"btn btn-primary mb-2",type:"button",onClick:()=>J(),disabled:_,children:_?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-loading mdi-spin me-1"}),"Sincronizando"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-cloud-download me-1"}),"Sincronizar"]})})]})}),e.jsx(Ue,{colors:R,setColors:k,settings:x,setSettings:g}),e.jsx(Be,{dataLoaded:U,setDataLoaded:V,modalRef:h}),e.jsx(Oe,{dataLoaded:U,setDataLoaded:V,setPages:j,modalRef:a,models:m}),e.jsx(De,{dataLoaded:Y,setDataLoaded:N,setSystems:d,modalRef:o})]})};ke((s,n)=>{Ce.createRoot(s).render(e.jsx(He,{...n}))});
